# =============================================================================
# Example Environment Configuration
# Copy this file to .env and replace all placeholder values
# =============================================================================

# =============================================================================
# Core Settings
# =============================================================================
ENVIRONMENT=development
LOG_LEVEL=INFO

# =============================================================================
# Container Registry & Versioning (for production deployments)
# =============================================================================
# Registry for docker images (e.g., ghcr.io/myorg, docker.io/myuser)
REGISTRY=ghcr.io/yourorg

# Image version tag - must match the version in .version file
VERSION=1.1.0

# Image prefix (used for naming images, default: insightmesh)
IMAGE_PREFIX=insightmesh

# Production deployment uses docker-compose.prod.yml which pulls from registry
# Build and push images: make release REGISTRY=ghcr.io/yourorg
# Deploy to production: docker compose -f docker-compose.prod.yml up -d

# =============================================================================
# Signal Room (Slack)
# =============================================================================
SLACK_BOT_TOKEN=xoxb-your-bot-token
SLACK_APP_TOKEN=xapp-your-app-token
SLACK_BOT_ID=B12345678

# =============================================================================
# Portal API (8th Light Employee Portal)
# =============================================================================
PORTAL_SECRET=your-portal-jwt-secret
PORTAL_URL=https://api.portal.8thlight.com
PORTAL_EMAIL=bot@8thlight.com

# =============================================================================
# Metric.ai API
# =============================================================================
METRIC_API_KEY=your-metric-api-key

# =============================================================================
# LLM Provider Configuration
# =============================================================================
LLM_API_URL=https://api.openai.com/v1
LLM_API_KEY=sk-your-openai-key
OPENAI_API_KEY=${LLM_API_KEY}
LLM_MODEL=gpt-4o
LLM_MAX_TOKENS=4096
LLM_TEMPERATURE=0.68

# =============================================================================
# Google Services
# =============================================================================
GOOGLE_OAUTH_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_OAUTH_CLIENT_SECRET=your-client-secret
GOOGLE_CALLBACK_URL=/oauth/google/callback

GEMINI_ENABLED=false
GEMINI_API_KEY=your-gemini-key
GEMINI_MODEL=gemini-2.5-pro

# =============================================================================
# RAG Configuration
# =============================================================================
RAG_QUERY_REWRITE_MODEL=gpt-4o-mini
RAG_ENABLE_QUERY_REWRITING=true
RAG_ENABLE_CONTEXTUAL_RETRIEVAL=true
RAG_MAX_CHUNKS=25
RAG_MAX_RESULTS=10
RAG_SIMILARITY_THRESHOLD=0.3
RAG_RESULTS_SIMILARITY_THRESHOLD=0.5
RAG_MAX_CHUNKS_PER_DOCUMENT=3
RAG_ENTITY_CONTENT_BOOST=0.05
RAG_ENTITY_TITLE_BOOST=0.1

# =============================================================================
# Vector Database (Qdrant)
# =============================================================================
VECTOR_PROVIDER=qdrant
VECTOR_HOST=localhost
VECTOR_PORT=6333
VECTOR_API_KEY=your-qdrant-api-key
VECTOR_COLLECTION_NAME=insightmesh-knowledge-base
VECTOR_ENABLED=false

# =============================================================================
# Embedding Configuration
# =============================================================================
EMBEDDING_PROVIDER=openai
EMBEDDING_MODEL=text-embedding-3-large
EMBEDDING_API_KEY=sk-your-openai-key

# =============================================================================
# Redis Cache
# =============================================================================
CACHE_REDIS_URL=redis://redis:6379
CACHE_CONVERSATION_TTL=1800
CACHE_ENABLED=true

# =============================================================================
# MinIO S3-Compatible Storage
# =============================================================================
MINIO_ENDPOINT=http://minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin

# =============================================================================
# Conversation Management
# =============================================================================
CONVERSATION_MAX_MESSAGES=21
CONVERSATION_KEEP_RECENT=7
CONVERSATION_SUMMARIZE_THRESHOLD=0.80
CONVERSATION_MODEL_CONTEXT_WINDOW=128000

# =============================================================================
# Database Configuration
# =============================================================================
DATA_DATABASE_URL=mysql+pymysql://username:password@localhost:3306/insightmesh_data
TASK_DATABASE_URL=mysql+pymysql://username:password@localhost:3306/insightmesh_task
SYSTEM_DATABASE_URL=mysql+pymysql://username:password@localhost:3306/insightmesh_system
SECURITY_DATABASE_URL=mysql+pymysql://username:password@localhost:3306/insightmesh_security

# MySQL Docker Initialization
MYSQL_ROOT_PASSWORD=your-root-password
MYSQL_TASKS_PASSWORD=your-tasks-password
MYSQL_DATA_PASSWORD=your-data-password
MYSQL_SECURITY_PASSWORD=your-security-password
MYSQL_SYSTEM_PASSWORD=your-system-password

# =============================================================================
# Control Plane Configuration
# =============================================================================
CONTROL_PLANE_PORT=6001
CONTROL_PLANE_URL=https://control-plane:6001
CONTROL_PLANE_INTERNAL_URL=https://control-plane:6001
CONTROL_PLANE_BASE_URL=http://localhost:6001

CONTROL_PLANE_SECRET_KEY=your-control-plane-secret
SECRET_KEY=your-flask-secret-key

# JWT Authentication with Refresh Tokens (OAuth 2.0 best practice)
# Generate secure secret: openssl rand -hex 32
JWT_SECRET_KEY=your-jwt-signing-key
# Access token lifetime (short for security): 15 minutes recommended
JWT_EXPIRATION_MINUTES=15
# Refresh token lifetime (longer for UX): 7 days recommended
REFRESH_TOKEN_DAYS=7

ALLOWED_EMAIL_DOMAIN=*
USER_MANAGEMENT_PROVIDER=slack
ALLOWED_ORIGINS=http://localhost:3080,http://localhost:5001,http://localhost:6001

# =============================================================================
# Agent Service Configuration
# =============================================================================
AGENT_EXECUTION_MODE=embedded
AGENT_SERVICE_URL=https://agent-service:8000
RAG_SERVICE_URL=http://rag-service:8002

# =============================================================================
# Service-to-Service Authentication
# =============================================================================
# Generate tokens with: openssl rand -hex 32
SERVICE_TOKEN=your-unified-service-token
BOT_SERVICE_TOKEN=your-bot-service-token
CONTROL_PLANE_SERVICE_TOKEN=your-control-plane-service-token
RAG_SERVICE_TOKEN=your-rag-service-token
LIBRECHAT_SERVICE_TOKEN=your-librechat-service-token
AGENT_SERVICE_TOKEN=your-agent-service-token

# =============================================================================
# Observability (Langfuse & LangSmith)
# =============================================================================
LANGFUSE_ENABLED=true
LANGFUSE_PUBLIC_KEY=pk-lf-your-public-key
LANGFUSE_SECRET_KEY=sk-lf-your-secret-key
LANGFUSE_HOST=https://us.cloud.langfuse.com
LANGFUSE_DEBUG=false
LANGFUSE_USE_PROMPT_TEMPLATES=true
LANGFUSE_SYSTEM_PROMPT_TEMPLATE=System/Default

LANGSMITH_API_KEY=lsv2-your-langsmith-key

PROXY_API_KEY=your-proxy-api-key
LANGCHAIN_ENDPOINT=http://langsmith-proxy:8003
LANGCHAIN_API_KEY=${PROXY_API_KEY}

# =============================================================================
# Web Search Tools
# =============================================================================
TAVILY_API_KEY=tvly-your-tavily-key
PERPLEXITY_API_KEY=pplx-your-perplexity-key
PERPLEXITY_ENABLED=true

# =============================================================================
# LibreChat Configuration
# =============================================================================
LIBRECHAT_MONGO_PASSWORD=your-mongodb-password
LIBRECHAT_JWT_SECRET=your-jwt-secret
LIBRECHAT_JWT_REFRESH_SECRET=your-jwt-refresh-secret
LIBRECHAT_CREDS_KEY=your-creds-key
LIBRECHAT_CREDS_IV=your-creds-iv
LIBRECHAT_DOMAIN_CLIENT=http://localhost:3080
LIBRECHAT_DOMAIN_SERVER=http://localhost:3080
LIBRECHAT_ALLOW_REGISTRATION=true
LIBRECHAT_ALLOW_EMAIL_LOGIN=false
LIBRECHAT_ALLOW_UNVERIFIED_EMAIL_LOGIN=true
LIBRECHAT_ALLOW_SOCIAL_LOGIN=true

# =============================================================================
# Application Settings
# =============================================================================
HEALTH_PORT=8080
TASKS_PORT=5001
SERVER_BASE_URL=http://localhost:5001

# =============================================================================
# Monitoring
# =============================================================================
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000

# =============================================================================
# Advanced Configuration
# =============================================================================
GRPC_VERBOSITY=ERROR
GRPC_TRACE=
PDF_STYLE=professional

# OAuth Token Encryption (generate with Fernet)
# python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
OAUTH_ENCRYPTION_KEY=your-fernet-key

# =============================================================================
# Unused / Placeholder
# =============================================================================
LANGGRAPH_CLOUD_URL=
LANGGRAPH_API_KEY=
